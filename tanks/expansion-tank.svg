<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 400" id="expansion-tank-widget">
  <defs>
    <linearGradient id="waterGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#0277bd;stop-opacity:0.8" />
      <stop offset="100%" style="stop-color:#01579b;stop-opacity:0.9" />
    </linearGradient>
    <linearGradient id="airGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:0.6" />
      <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:0.7" />
    </linearGradient>
    <linearGradient id="tankMetal" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#90a4ae;stop-opacity:0.9" />
      <stop offset="50%" style="stop-color:#cfd8dc;stop-opacity:0.95" />
      <stop offset="100%" style="stop-color:#90a4ae;stop-opacity:0.9" />
    </linearGradient>
    <radialGradient id="pressureGaugeGradient">
      <stop offset="0%" style="stop-color:#ffffff;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#e0e0e0;stop-opacity:1" />
    </radialGradient>
    <filter id="glow">
      <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="300" height="400" fill="#f5f5f5"/>

  <!-- Title -->
  <text x="150" y="25" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#333">
    Expansion Tank
  </text>

  <!-- Tank Container (Diaphragm type) -->
  <g id="tank-container">
    <!-- Tank shell -->
    <ellipse cx="150" cy="160" rx="80" ry="110" fill="url(#tankMetal)" stroke="#546e7a" stroke-width="3"/>

    <!-- Air chamber (top) -->
    <ellipse id="air-chamber" cx="150" cy="100" rx="75" ry="55" fill="url(#airGradient)" stroke="#546e7a" stroke-width="1" opacity="0.8"/>

    <!-- Water chamber (bottom) -->
    <path id="water-chamber" d="M 75 160 Q 75 240 150 260 Q 225 240 225 160 Z" fill="url(#waterGradient)" stroke="#546e7a" stroke-width="1" opacity="0.9"/>

    <!-- Diaphragm/bladder separator line -->
    <ellipse id="diaphragm" cx="150" cy="160" rx="73" ry="8" fill="none" stroke="#333" stroke-width="2" stroke-dasharray="5,3"/>

    <!-- System connection (bottom) -->
    <g id="system-connection">
      <rect x="140" y="265" width="20" height="25" fill="#757575" stroke="#333" stroke-width="2"/>
      <rect x="135" y="287" width="30" height="8" fill="#757575" stroke="#333" stroke-width="2"/>
      <text x="150" y="308" font-family="Arial" font-size="10" text-anchor="middle" fill="#333">SYSTEM</text>
    </g>

    <!-- Air valve (top) -->
    <g id="air-valve">
      <rect x="145" y="40" width="10" height="15" fill="#333" stroke="#333" stroke-width="1"/>
      <circle cx="150" cy="38" r="4" fill="#ff9800" stroke="#333" stroke-width="1"/>
      <text x="150" y="28" font-family="Arial" font-size="9" text-anchor="middle" fill="#333">AIR</text>
    </g>
  </g>

  <!-- Pressure Gauge -->
  <g id="pressure-gauge" transform="translate(40, 140)">
    <circle cx="0" cy="0" r="35" fill="url(#pressureGaugeGradient)" stroke="#333" stroke-width="2"/>
    <circle cx="0" cy="0" r="30" fill="none" stroke="#666" stroke-width="1"/>

    <!-- Gauge markings -->
    <g id="gauge-marks">
      <line x1="0" y1="-25" x2="0" y2="-22" stroke="#333" stroke-width="2"/>
      <line x1="17.7" y1="-17.7" x2="15.6" y2="-15.6" stroke="#333" stroke-width="1.5"/>
      <line x1="25" y1="0" x2="22" y2="0" stroke="#333" stroke-width="2"/>
      <line x1="17.7" y1="17.7" x2="15.6" y2="15.6" stroke="#333" stroke-width="1.5"/>
      <line x1="0" y1="25" x2="0" y2="22" stroke="#333" stroke-width="1.5"/>

      <text x="0" y="-15" font-family="Arial" font-size="8" text-anchor="middle" fill="#333">30</text>
      <text x="15" y="5" font-family="Arial" font-size="8" text-anchor="middle" fill="#333">15</text>
      <text x="0" y="18" font-family="Arial" font-size="8" text-anchor="middle" fill="#333">0</text>
    </g>

    <!-- Pressure needle -->
    <line id="pressure-needle" x1="0" y1="0" x2="0" y2="-20" stroke="#ff5252" stroke-width="2" stroke-linecap="round"/>
    <circle cx="0" cy="0" r="3" fill="#333"/>

    <!-- PSI label -->
    <text x="0" y="32" font-family="Arial" font-size="8" text-anchor="middle" fill="#333">PSI</text>
  </g>

  <!-- Pre-charge pressure indicator -->
  <g id="precharge-indicator">
    <rect x="15" y="195" width="50" height="30" fill="#ffffff" stroke="#333" stroke-width="1.5" rx="3"/>
    <text x="40" y="208" font-family="Arial" font-size="9" text-anchor="middle" fill="#666">Pre-Chg</text>
    <text x="40" y="220" font-family="Arial" font-size="11" font-weight="bold" text-anchor="middle" fill="#333">
      <tspan id="precharge-psi">12</tspan> PSI
    </text>
  </g>

  <!-- Level indicator -->
  <g id="level-indicator">
    <rect x="240" y="80" width="30" height="160" fill="#ffffff" stroke="#333" stroke-width="2" rx="5"/>
    <rect id="level-fill" x="242" y="160" width="26" height="78" fill="#0277bd" rx="3"/>

    <!-- Level markings -->
    <line x1="240" y1="100" x2="245" y2="100" stroke="#333" stroke-width="1"/>
    <line x1="240" y1="140" x2="245" y2="140" stroke="#333" stroke-width="1"/>
    <line x1="240" y1="180" x2="245" y2="180" stroke="#333" stroke-width="1"/>
    <line x1="240" y1="220" x2="245" y2="220" stroke="#333" stroke-width="1"/>

    <text x="255" y="95" font-family="Arial" font-size="9" text-anchor="middle" fill="#333">100</text>
    <text x="255" y="145" font-family="Arial" font-size="9" text-anchor="middle" fill="#333">50</text>
    <text x="255" y="225" font-family="Arial" font-size="9" text-anchor="middle" fill="#333">0</text>

    <text x="255" y="75" font-family="Arial" font-size="8" text-anchor="middle" fill="#666">LEVEL %</text>
  </g>

  <!-- Status indicators -->
  <g id="status-indicators">

  <script><![CDATA[
//!export-start
let _pn_level = 65;      // Tank level (%)
let _pn_capacity = 1000; // Tank capacity (gallons)
let _pn_temperature = 72; // Temperature (°F)
let _ps_label = "Expansion Tank"; // Tank label
//!export-end

function init() { update(); }

function update() {
  const fillRect = document.getElementById('tankFill');
  const levelText = document.getElementById('levelText');
  const capacityText = document.getElementById('capacityText');
  const tempText = document.getElementById('tempText');
  const labelText = document.getElementById('tankLabel');
  if (!fillRect) return;
  const fillHeight = (_pn_level / 100) * 150;
  fillRect.setAttribute('height', fillHeight);
  fillRect.setAttribute('y', 150 - fillHeight);
  if (levelText) levelText.textContent = _pn_level + '%';
  if (capacityText) capacityText.textContent = Math.round(_pn_capacity * _pn_level / 100) + ' gal';
  if (tempText) tempText.textContent = _pn_temperature + '°F';
  if (labelText) labelText.textContent = _ps_label;
}

function putValue(id, value) {
  if (id === '_pn_level') _pn_level = Number(value) || 0;
  else if (id === '_pn_capacity') _pn_capacity = Number(value) || 0;
  else if (id === '_pn_temperature') _pn_temperature = Number(value) || 0;
  else if (id === '_ps_label') _ps_label = String(value);
  update();
}

init();
]]></script>
</svg>
