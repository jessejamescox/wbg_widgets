<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 40" width="100%" height="100%">
  <defs>
    <style>
      .chip-body { fill: #2c3e50; stroke: #95a5a6; stroke-width: 1.5; }
      .icon { fill: #9b59b6; stroke: #ffffff; stroke-width: 1; }
      .value-text { font-family: Arial, sans-serif; font-size: 14px; fill: #ffffff; font-weight: bold; }
      .unit-text { font-family: Arial, sans-serif; font-size: 9px; fill: #546e7a; }
      .label-text { font-family: Arial, sans-serif; font-size: 8px; fill: #546e7a; }
      .alarm-state { fill: #e74c3c; }
      .normal-state { fill: #27ae60; }
    </style>
  </defs>

  <!-- Chip Body -->
  <rect x="2" y="2" width="76" height="36" class="chip-body" rx="4"/>

  <!-- Pressure Gauge Icon -->
  <circle cx="15" cy="20" r="8" class="icon" fill="none"/>
  <path d="M 15 20 L 19 14" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round"/>
  <circle cx="15" cy="20" r="2" fill="#2c3e50"/>

  <!-- Value Display -->
  <text id="valueText" x="42" y="22" class="value-text" text-anchor="middle">45.2</text>
  <text id="unitText" x="64" y="22" class="unit-text">PSI</text>

  <!-- Label -->
  <text x="40" y="34" class="label-text" text-anchor="middle">PRESSURE</text>

  <!-- Status Indicator -->
  <circle id="statusDot" cx="73" cy="8" r="3" class="normal-state"/>

  <script><![CDATA[
//!export-start
let _pn_pressure = 45.2;     // Pressure value
let _ps_units = 'PSI';       // Pressure units: 'PSI', 'kPa', 'bar', etc.
let _pn_highAlarm = 60;      // High pressure alarm setpoint
let _pn_lowAlarm = 20;       // Low pressure alarm setpoint
let _pn_alarmState = 0;      // Alarm state: 0=normal, 1=alarm
//!export-end

function init() {
  update();
}

    function update() {
const valueText = document.getElementById('valueText');
const unitText = document.getElementById('unitText');
const statusDot = document.getElementById('statusDot');

  if (!valueText || !unitText || !statusDot) return;

      // Update value and units
      valueText.textContent = _pn_pressure.toFixed(1);
      unitText.textContent = _ps_units;

      // Check alarm conditions
      if (_pn_pressure > _pn_highAlarm || _pn_pressure < _pn_lowAlarm || _pn_alarmState === 1) {
        statusDot.setAttribute('class', 'alarm-state');
        valueText.setAttribute('fill', '#e74c3c');
      } else {
        statusDot.setAttribute('class', 'normal-state');
        valueText.setAttribute('fill', '#ffffff');
      }
    }

function putValue(id, value) {
  if (id === '_pn_pressure') {
    _pn_pressure = Number(value) || 0;
    update();
  } else if (id === '_ps_units') {
    _ps_units = String(value) || "";
    update();
  } else if (id === '_pn_highAlarm') {
    _pn_highAlarm = Number(value) || 0;
    update();
  } else if (id === '_pn_lowAlarm') {
    _pn_lowAlarm = Number(value) || 0;
    update();
  } else if (id === '_pn_alarmState') {
    _pn_alarmState = Number(value) || 0;
    update();
  }
}

init();

]]></script>
</svg>
