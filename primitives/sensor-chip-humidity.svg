<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 40" width="100%" height="100%">
  <defs>
    <style>
      .chip-body { fill: #ecf0f1; stroke: #95a5a6; stroke-width: 1.5; }
      .icon { fill: #3498db; }
      .value-text { font-family: Arial, sans-serif; font-size: 14px; fill: #2c3e50; font-weight: bold; }
      .unit-text { font-family: Arial, sans-serif; font-size: 9px; fill: #7f8c8d; }
      .label-text { font-family: Arial, sans-serif; font-size: 8px; fill: #95a5a6; }
      .alarm-state { fill: #e74c3c; }
      .normal-state { fill: #27ae60; }
    </style>
  </defs>

  <!-- Chip Body -->
  <rect x="2" y="2" width="76" height="36" class="chip-body" rx="4"/>

  <!-- Humidity Icon (water drop) -->
  <path class="icon" d="M 15 10 Q 10 15, 10 20 Q 10 25, 15 28 Q 20 25, 20 20 Q 20 15, 15 10 Z"/>

  <!-- Value Display -->
  <text id="valueText" x="45" y="22" class="value-text" text-anchor="middle">55</text>
  <text x="63" y="22" class="unit-text">%RH</text>

  <!-- Label -->
  <text x="40" y="34" class="label-text" text-anchor="middle">HUMIDITY</text>

  <!-- Status Indicator -->
  <circle id="statusDot" cx="73" cy="8" r="3" class="normal-state"/>

  <script><![CDATA[
//!export-start
let _pn_humidity = 55;       // Relative humidity percentage (0-100%)
let _pn_highAlarm = 70;      // High humidity alarm setpoint
let _pn_lowAlarm = 30;       // Low humidity alarm setpoint
let _pn_alarmState = 0;      // Alarm state: 0=normal, 1=alarm
//!export-end

function init() {
  update();
}

    function update() {
const valueText = document.getElementById('valueText');
const statusDot = document.getElementById('statusDot');

  if (!valueText || !statusDot) return;

      // Update value
      valueText.textContent = Math.round(_pn_humidity);

      // Check alarm conditions
      if (_pn_humidity > _pn_highAlarm || _pn_humidity < _pn_lowAlarm || _pn_alarmState === 1) {
        statusDot.setAttribute('class', 'alarm-state');
        valueText.setAttribute('fill', '#e74c3c');
      } else {
        statusDot.setAttribute('class', 'normal-state');
        valueText.setAttribute('fill', '#2c3e50');
      }
    }

function putValue(id, value) {
  if (id === '_pn_humidity') {
    _pn_humidity = Number(value) || 0;
    update();
  } else if (id === '_pn_highAlarm') {
    _pn_highAlarm = Number(value) || 0;
    update();
  } else if (id === '_pn_lowAlarm') {
    _pn_lowAlarm = Number(value) || 0;
    update();
  } else if (id === '_pn_alarmState') {
    _pn_alarmState = Number(value) || 0;
    update();
  }
}

init();

]]></script>
</svg>
