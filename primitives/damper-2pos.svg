<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 80" width="100%" height="100%">
  <defs>
    <style>
      .duct { fill: #eceff1; stroke: #f5f7fa; stroke-width: 2; }
      .damper-blade { fill: #546e7a; stroke: #ffffff; stroke-width: 2; transition: transform 0.5s; }
      .actuator { fill: #546e7a; stroke: #ffffff; stroke-width: 1.5; }
      .status-text { font-family: Arial, sans-serif; font-size: 11px; fill: #ffffff; text-anchor: middle; font-weight: bold; }
    </style>
  </defs>

  <!-- Duct -->
  <rect x="5" y="25" width="90" height="30" class="duct" rx="2"/>

  <!-- Single Damper Blade -->
  <g id="damperBlade" transform-origin="50 40">
    <rect x="10" y="30" width="80" height="20" class="damper-blade" rx="2"/>
  </g>

  <!-- Actuator -->
  <rect x="83" y="12" width="12" height="8" class="actuator" rx="2"/>
  <line x1="89" y1="20" x2="89" y2="30" stroke="#ffffff" stroke-width="1.5"/>

  <!-- Status Display -->
  <rect id="statusBox" x="25" y="62" width="50" height="16" fill="#e74c3c" rx="3"/>
  <text id="statusText" x="50" y="73" class="status-text">CLOSED</text>

  <script><![CDATA[
//!export-start
let _pn_position = 0;    // Commanded damper position: 0=closed, 1=open
let _pn_feedback = 0;    // Actual position feedback: 0=closed, 1=open
//!export-end

function init() {
  update();
}

    function update() {
const blade = document.getElementById('damperBlade');
const statusBox = document.getElementById('statusBox');
const statusText = document.getElementById('statusText');

  if (!blade || !statusBox || !statusText) return;

      if (_pn_position === 1) {
        // Open - horizontal
        blade.setAttribute('transform', 'rotate(90 50 40)');
        statusBox.setAttribute('fill', '#27ae60');
        statusText.textContent = 'OPEN';
      } else {
        // Closed - vertical
        blade.setAttribute('transform', 'rotate(0 50 40)');
        statusBox.setAttribute('fill', '#e74c3c');
        statusText.textContent = 'CLOSED';
      }

      // Show transition state
      if (_pn_position !== _pn_feedback) {
        statusBox.setAttribute('fill', '#f39c12');
        statusText.textContent = 'MOVING';
      }
    }

function putValue(id, value) {
  if (id === '_pn_position') {
    _pn_position = Number(value) || 0;
    update();
  } else if (id === '_pn_feedback') {
    _pn_feedback = Number(value) || 0;
    update();
  }
}

init();

]]></script>
</svg>
