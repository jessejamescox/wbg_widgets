<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 80" width="100%" height="100%">
  <defs>
    <style>
      .duct { fill: #bdc3c7; stroke: #34495e; stroke-width: 2; }
      .coil-tube { fill: none; stroke: #e67e22; stroke-width: 3; }
      .coil-tube-active { stroke: #e74c3c; }
      .fin { fill: #95a5a6; stroke: #7f8c8d; stroke-width: 0.5; }
      .pipe { fill: none; stroke: #d35400; stroke-width: 3; }
      .valve { fill: #7f8c8d; stroke: #2c3e50; stroke-width: 1.5; }
      .value-text { font-family: Arial, sans-serif; font-size: 10px; fill: #2c3e50; text-anchor: middle; font-weight: bold; }
    </style>
  </defs>

  <!-- Duct/Casing -->
  <rect x="5" y="20" width="90" height="40" class="duct" rx="2"/>

  <!-- Heating Coil Fins -->
  <g id="fins">
    <rect x="15" y="22" width="2" height="36" class="fin"/>
    <rect x="20" y="22" width="2" height="36" class="fin"/>
    <rect x="25" y="22" width="2" height="36" class="fin"/>
    <rect x="30" y="22" width="2" height="36" class="fin"/>
    <rect x="35" y="22" width="2" height="36" class="fin"/>
    <rect x="40" y="22" width="2" height="36" class="fin"/>
    <rect x="45" y="22" width="2" height="36" class="fin"/>
    <rect x="50" y="22" width="2" height="36" class="fin"/>
    <rect x="55" y="22" width="2" height="36" class="fin"/>
    <rect x="60" y="22" width="2" height="36" class="fin"/>
    <rect x="65" y="22" width="2" height="36" class="fin"/>
    <rect x="70" y="22" width="2" height="36" class="fin"/>
    <rect x="75" y="22" width="2" height="36" class="fin"/>
    <rect x="80" y="22" width="2" height="36" class="fin"/>
  </g>

  <!-- Heating Coil Tubes (serpentine pattern) -->
  <g id="coilTubes">
    <path class="coil-tube" d="M 12 28 L 85 28"/>
    <path class="coil-tube" d="M 85 28 L 85 35"/>
    <path class="coil-tube" d="M 85 35 L 12 35"/>
    <path class="coil-tube" d="M 12 35 L 12 42"/>
    <path class="coil-tube" d="M 12 42 L 85 42"/>
    <path class="coil-tube" d="M 85 42 L 85 49"/>
    <path class="coil-tube" d="M 85 49 L 12 49"/>
  </g>

  <!-- Hot Water Supply -->
  <line x1="5" y1="10" x2="12" y2="28" class="pipe"/>
  <text x="2" y="8" class="value-text" font-size="8">HW SUP</text>

  <!-- Hot Water Return -->
  <line x1="12" y1="49" x2="5" y2="65" class="pipe"/>
  <text x="2" y="75" class="value-text" font-size="8">HW RET</text>

  <!-- Valve -->
  <rect x="3" y="8" width="4" height="6" class="valve" rx="1"/>

  <!-- Temperature Display -->
  <rect x="35" y="65" width="30" height="12" fill="#ecf0f1" stroke="#95a5a6" stroke-width="1" rx="2"/>
  <text id="tempText" x="50" y="73" class="value-text">---째F</text>

  <script><![CDATA[
//!export-start
let _pn_valvePosition = 0;
let _pn_supplyTemp = 0;
let _pn_returnTemp = 0;
let _pn_airTempOut = 0;
let _pn_active = 0;
//!export-end

function init() {
  update();
}

    function update() {
const coilTubes = document.getElementById('coilTubes');
const tempText = document.getElementById('tempText');

  if (!coilTubes || !tempText) return;

      if (_pn_valvePosition > 10 && _pn_supplyTemp > 0) {
        // Active heating
let paths = coilTubes.querySelectorAll('path');
        paths.forEach(function(path) {
          path.setAttribute('class', 'coil-tube coil-tube-_pn_active');
        });

        if (_pn_airTempOut > 0) {
          tempText.textContent = Math.round(_pn_airTempOut) + '째F';
        } else {
          tempText.textContent = Math.round(_pn_supplyTemp) + '째F';
        }
      } else {
        // Inactive
let paths = coilTubes.querySelectorAll('path');
        paths.forEach(function(path) {
          path.setAttribute('class', 'coil-tube');
        });
        tempText.textContent = '---째F';
      }
    }

function putValue(id, value) {
  if (id === '_pn_valvePosition') {
    _pn_valvePosition = Number(value) || 0;
    update();
  } else if (id === '_pn_supplyTemp') {
    _pn_supplyTemp = Number(value) || 0;
    update();
  } else if (id === '_pn_returnTemp') {
    _pn_returnTemp = Number(value) || 0;
    update();
  } else if (id === '_pn_airTempOut') {
    _pn_airTempOut = Number(value) || 0;
    update();
  } else if (id === '_pn_active') {
    _pn_active = Number(value) || 0;
    update();
  }
}

init();

]]></script>
</svg>
