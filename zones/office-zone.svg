<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 500">
  <defs>
    <style>
      .office-bg { fill: #1a1a2e; }
      .office-header { fill: #16213e; }
      .office-card { fill: #2d3748; }
      .office-text-primary { fill: #ffffff; font-family: 'Segoe UI', Arial, sans-serif; font-size: 16px; font-weight: 600; }
      .office-text-secondary { fill: #a0aec0; font-family: 'Segoe UI', Arial, sans-serif; font-size: 13px; }
      .office-text-large { fill: #ffffff; font-family: 'Segoe UI', Arial, sans-serif; font-size: 24px; font-weight: 700; }
      .office-text-medium { fill: #ffffff; font-family: 'Segoe UI', Arial, sans-serif; font-size: 14px; font-weight: 600; }
      .office-text-small { fill: #cbd5e0; font-family: 'Segoe UI', Arial, sans-serif; font-size: 11px; }
      .office-icon { fill: none; stroke: #4299e1; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
      .office-border { fill: none; stroke: #2d3748; stroke-width: 2; }
      .office-space { fill: #2d3748; stroke: #4a5568; stroke-width: 1; cursor: pointer; }
      .office-space:hover { fill: #3d4758; }
      .office-vav { fill: #2d3748; stroke: #4299e1; stroke-width: 1; }
      .temp-cold { fill: #4299e1; }
      .temp-cool { fill: #68d391; }
      .temp-neutral { fill: #48bb78; }
      .temp-warm { fill: #ed8936; }
      .temp-hot { fill: #f56565; }
    </style>

    <linearGradient id="tempMapGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#4299e1;stop-opacity:1" />
      <stop offset="25%" style="stop-color:#68d391;stop-opacity:1" />
      <stop offset="50%" style="stop-color:#48bb78;stop-opacity:1" />
      <stop offset="75%" style="stop-color:#ed8936;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#f56565;stop-opacity:1" />
    </linearGradient>
  </defs>

  <!-- Main Background -->
  <rect class="office-bg" x="0" y="0" width="700" height="500" rx="12"/>
  <rect class="office-border" x="0" y="0" width="700" height="500" rx="12"/>

  <!-- Header -->
  <rect class="office-header" x="0" y="0" width="700" height="60" rx="12"/>
  <rect class="office-header" x="0" y="30" width="700" height="30"/>
  <text class="office-text-large" x="20" y="38" id="zoneName">Office Zone - 3rd Floor</text>

  <!-- Zone Summary Stats -->
  <g transform="translate(450, 20)">
    <g transform="translate(0, 0)">
      <text class="office-text-small" x="0" y="0">Avg Temp:</text>
      <text class="office-text-medium" x="0" y="16" id="avgTemp">72°F</text>
    </g>
    <g transform="translate(80, 0)">
      <text class="office-text-small" x="0" y="0">Occupancy:</text>
      <text class="office-text-medium" x="0" y="16" id="totalOccupancy">24/30</text>
    </g>
    <g transform="translate(160, 0)">
      <text class="office-text-small" x="0" y="0">VAV Boxes:</text>
      <text class="office-text-medium" x="0" y="16" id="vavStatus">6 Active</text>
    </g>
  </g>

  <!-- Temperature Map Section -->
  <g transform="translate(20, 80)">
    <rect class="office-card" x="0" y="0" width="420" height="300" rx="8"/>
    <rect class="office-border" x="0" y="0" width="420" height="300" rx="8"/>

    <text class="office-text-primary" x="15" y="25">Temperature Distribution Map</text>

    <!-- Floor Plan Grid -->
    <g transform="translate(20, 45)">
      <!-- Space 1 -->
      <g id="space1" class="office-space">
        <rect x="0" y="0" width="90" height="100" rx="4" class="temp-neutral"/>
        <text class="office-text-medium" x="45" y="45" text-anchor="middle" fill="#ffffff">Office 301</text>
        <text class="office-text-small" x="45" y="65" text-anchor="middle" fill="#ffffff" id="temp1">72°F</text>
        <text class="office-text-small" x="45" y="80" text-anchor="middle" fill="#cbd5e0" id="occ1">3 people</text>
      </g>

      <!-- Space 2 -->
      <g id="space2" class="office-space" transform="translate(100, 0)">
        <rect x="0" y="0" width="90" height="100" rx="4" class="temp-cool"/>
        <text class="office-text-medium" x="45" y="45" text-anchor="middle" fill="#ffffff">Office 302</text>
        <text class="office-text-small" x="45" y="65" text-anchor="middle" fill="#ffffff" id="temp2">70°F</text>
        <text class="office-text-small" x="45" y="80" text-anchor="middle" fill="#cbd5e0" id="occ2">2 people</text>
      </g>

      <!-- Space 3 -->
      <g id="space3" class="office-space" transform="translate(200, 0)">
        <rect x="0" y="0" width="90" height="100" rx="4" class="temp-warm"/>
        <text class="office-text-medium" x="45" y="45" text-anchor="middle" fill="#ffffff">Office 303</text>
        <text class="office-text-small" x="45" y="65" text-anchor="middle" fill="#ffffff" id="temp3">74°F</text>
        <text class="office-text-small" x="45" y="80" text-anchor="middle" fill="#cbd5e0" id="occ3">5 people</text>
      </g>

      <!-- Space 4 -->
      <g id="space4" class="office-space" transform="translate(300, 0)">
        <rect x="0" y="0" width="90" height="100" rx="4" class="temp-neutral"/>
        <text class="office-text-medium" x="45" y="45" text-anchor="middle" fill="#ffffff">Meeting A</text>
        <text class="office-text-small" x="45" y="65" text-anchor="middle" fill="#ffffff" id="temp4">71°F</text>
        <text class="office-text-small" x="45" y="80" text-anchor="middle" fill="#cbd5e0" id="occ4">8 people</text>
      </g>

      <!-- Space 5 -->
      <g id="space5" class="office-space" transform="translate(0, 110)">
        <rect x="0" y="0" width="140" height="110" rx="4" class="temp-cool"/>
        <text class="office-text-medium" x="70" y="50" text-anchor="middle" fill="#ffffff">Open Office</text>
        <text class="office-text-small" x="70" y="70" text-anchor="middle" fill="#ffffff" id="temp5">69°F</text>
        <text class="office-text-small" x="70" y="85" text-anchor="middle" fill="#cbd5e0" id="occ5">4 people</text>
      </g>

      <!-- Space 6 -->
      <g id="space6" class="office-space" transform="translate(150, 110)">
        <rect x="0" y="0" width="140" height="110" rx="4" class="temp-neutral"/>
        <text class="office-text-medium" x="70" y="50" text-anchor="middle" fill="#ffffff">Break Room</text>
        <text class="office-text-small" x="70" y="70" text-anchor="middle" fill="#ffffff" id="temp6">73°F</text>
        <text class="office-text-small" x="70" y="85" text-anchor="middle" fill="#cbd5e0" id="occ6">2 people</text>
      </g>

      <!-- Space 7 -->
      <g id="space7" class="office-space" transform="translate(300, 110)">
        <rect x="0" y="0" width="90" height="110" rx="4" class="temp-cold"/>
        <text class="office-text-medium" x="45" y="50" text-anchor="middle" fill="#ffffff">Server</text>
        <text class="office-text-small" x="45" y="70" text-anchor="middle" fill="#ffffff" id="temp7">65°F</text>
        <text class="office-text-small" x="45" y="85" text-anchor="middle" fill="#cbd5e0" id="occ7">0 people</text>
      </g>
    </g>

    <!-- Temperature Scale Legend -->
    <g transform="translate(20, 240)">
      <rect x="0" y="0" width="380" height="15" rx="4" fill="url(#tempMapGradient)"/>
      <text class="office-text-small" x="0" y="30">60°F</text>
      <text class="office-text-small" x="170" y="30" text-anchor="middle">72°F</text>
      <text class="office-text-small" x="380" y="30" text-anchor="end">85°F</text>
    </g>
  </g>

  <!-- VAV Boxes Panel -->
  <g transform="translate(460, 80)">
    <rect class="office-card" x="0" y="0" width="220" height="300" rx="8"/>
    <rect class="office-border" x="0" y="0" width="220" height="300" rx="8"/>

    <text class="office-text-primary" x="15" y="25">VAV Box Status</text>

    <!-- VAV Box 1 -->
    <g transform="translate(15, 40)">
      <rect class="office-vav" x="0" y="0" width="190" height="35" rx="4"/>
      <text class="office-text-medium" x="10" y="14">VAV-301</text>
      <text class="office-text-small" x="10" y="28" id="vav1Status">Cooling - 65%</text>
      <circle id="vav1Indicator" fill="#48bb78" cx="175" cy="17.5" r="6"/>
    </g>

    <!-- VAV Box 2 -->
    <g transform="translate(15, 85)">
      <rect class="office-vav" x="0" y="0" width="190" height="35" rx="4"/>
      <text class="office-text-medium" x="10" y="14">VAV-302</text>
      <text class="office-text-small" x="10" y="28" id="vav2Status">Cooling - 45%</text>
      <circle id="vav2Indicator" fill="#48bb78" cx="175" cy="17.5" r="6"/>
    </g>

    <!-- VAV Box 3 -->
    <g transform="translate(15, 130)">
      <rect class="office-vav" x="0" y="0" width="190" height="35" rx="4"/>
      <text class="office-text-medium" x="10" y="14">VAV-303</text>
      <text class="office-text-small" x="10" y="28" id="vav3Status">Heating - 30%</text>
      <circle id="vav3Indicator" fill="#f56565" cx="175" cy="17.5" r="6"/>
    </g>

    <!-- VAV Box 4 -->
    <g transform="translate(15, 175)">
      <rect class="office-vav" x="0" y="0" width="190" height="35" rx="4"/>
      <text class="office-text-medium" x="10" y="14">VAV-304</text>
      <text class="office-text-small" x="10" y="28" id="vav4Status">Cooling - 55%</text>
      <circle id="vav4Indicator" fill="#48bb78" cx="175" cy="17.5" r="6"/>
    </g>

    <!-- VAV Box 5 -->
    <g transform="translate(15, 220)">
      <rect class="office-vav" x="0" y="0" width="190" height="35" rx="4"/>
      <text class="office-text-medium" x="10" y="14">VAV-305</text>
      <text class="office-text-small" x="10" y="28" id="vav5Status">Cooling - 40%</text>
      <circle id="vav5Indicator" fill="#48bb78" cx="175" cy="17.5" r="6"/>
    </g>

    <!-- VAV Box 6 -->
    <g transform="translate(15, 265)">
      <rect class="office-vav" x="0" y="0" width="190" height="35" rx="4"/>
      <text class="office-text-medium" x="10" y="14">VAV-306</text>
      <text class="office-text-small" x="10" y="28" id="vav6Status">Cooling - 85%</text>
      <circle id="vav6Indicator" fill="#48bb78" cx="175" cy="17.5" r="6"/>
    </g>
  </g>

  <!-- System Alerts -->
  <g transform="translate(20, 400)">
    <rect class="office-card" x="0" y="0" width="660" height="80" rx="8"/>
    <rect class="office-border" x="0" y="0" width="660" height="80" rx="8"/>

    <text class="office-text-primary" x="15" y="25">System Status</text>

    <g transform="translate(15, 35)">
      <circle fill="#48bb78" cx="0" cy="5" r="5"/>
      <text class="office-text-small" x="15" y="10" id="alert1">All VAV boxes operating normally</text>
    </g>

    <g transform="translate(15, 55)">
      <circle fill="#ed8936" cx="0" cy="5" r="5"/>
      <text class="office-text-small" x="15" y="10" id="alert2">High occupancy in Office 303 - Consider temp adjustment</text>
    </g>
  </g>

  <script><![CDATA[
//!export-start
let _ps_zoneName = "Office Zone - 3rd Floor"; // Zone name
let _pn_avgTemp = 72;                          // Average temperature (°F)
let _pn_totalOccupancy = 24;                   // Total occupancy count
let _pn_maxOccupancy = 30;                     // Maximum occupancy
let _pn_vavActive = 6;                         // Number of active VAV boxes
let _pn_temp1 = 72;                            // Space 1 temperature (°F)
let _pn_occ1 = 3;                              // Space 1 occupancy
let _pn_temp2 = 70;                            // Space 2 temperature (°F)
let _pn_occ2 = 2;                              // Space 2 occupancy
let _pn_temp3 = 74;                            // Space 3 temperature (°F)
let _pn_occ3 = 5;                              // Space 3 occupancy
let _pn_temp4 = 71;                            // Space 4 temperature (°F)
let _pn_occ4 = 8;                              // Space 4 occupancy
let _pn_temp5 = 69;                            // Space 5 temperature (°F)
let _pn_occ5 = 4;                              // Space 5 occupancy
let _pn_temp6 = 73;                            // Space 6 temperature (°F)
let _pn_occ6 = 2;                              // Space 6 occupancy
let _pn_temp7 = 65;                            // Space 7 temperature (°F)
let _pn_occ7 = 0;                              // Space 7 occupancy
let _pn_vav1Damper = 65;                       // VAV 1 damper position (%)
let _pn_vav1Mode = 2;                          // VAV 1 mode: 0=off, 1=heating, 2=cooling
let _pn_vav2Damper = 45;                       // VAV 2 damper position (%)
let _pn_vav2Mode = 2;                          // VAV 2 mode
let _pn_vav3Damper = 30;                       // VAV 3 damper position (%)
let _pn_vav3Mode = 1;                          // VAV 3 mode
let _pn_vav4Damper = 55;                       // VAV 4 damper position (%)
let _pn_vav4Mode = 2;                          // VAV 4 mode
let _pn_vav5Damper = 40;                       // VAV 5 damper position (%)
let _pn_vav5Mode = 2;                          // VAV 5 mode
let _pn_vav6Damper = 85;                       // VAV 6 damper position (%)
let _pn_vav6Mode = 2;                          // VAV 6 mode
//!export-end

function init() {
  update();
}

function getTempClass(temp) {
  if (temp < 68) return 'temp-cold';
  if (temp < 70) return 'temp-cool';
  if (temp < 74) return 'temp-neutral';
  if (temp < 76) return 'temp-warm';
  return 'temp-hot';
}

function update() {
  const zoneNameElem = document.getElementById('zoneName');
  const avgTempElem = document.getElementById('avgTemp');
  const totalOccupancyElem = document.getElementById('totalOccupancy');
  const vavStatusElem = document.getElementById('vavStatus');

  if (!zoneNameElem) return;

  // Update zone name
  zoneNameElem.textContent = _ps_zoneName;

  // Update average temperature
  avgTempElem.textContent = Math.round(_pn_avgTemp) + '°F';

  // Update total occupancy
  totalOccupancyElem.textContent = _pn_totalOccupancy + '/' + _pn_maxOccupancy;

  // Update VAV status
  vavStatusElem.textContent = _pn_vavActive + ' Active';

  // Update space temperatures and occupancy
  const spaces = [
    { temp: _pn_temp1, occ: _pn_occ1, num: 1 },
    { temp: _pn_temp2, occ: _pn_occ2, num: 2 },
    { temp: _pn_temp3, occ: _pn_occ3, num: 3 },
    { temp: _pn_temp4, occ: _pn_occ4, num: 4 },
    { temp: _pn_temp5, occ: _pn_occ5, num: 5 },
    { temp: _pn_temp6, occ: _pn_occ6, num: 6 },
    { temp: _pn_temp7, occ: _pn_occ7, num: 7 }
  ];

  spaces.forEach(function(space) {
    const tempElem = document.getElementById('temp' + space.num);
    const occElem = document.getElementById('occ' + space.num);
    const spaceRect = document.querySelector('#space' + space.num + ' rect');

    if (tempElem) tempElem.textContent = Math.round(space.temp) + '°F';
    if (occElem) occElem.textContent = space.occ + ' people';
    if (spaceRect) spaceRect.setAttribute('class', getTempClass(space.temp));
  });

  // Update VAV boxes
  const vavs = [
    { damper: _pn_vav1Damper, mode: _pn_vav1Mode, num: 1 },
    { damper: _pn_vav2Damper, mode: _pn_vav2Mode, num: 2 },
    { damper: _pn_vav3Damper, mode: _pn_vav3Mode, num: 3 },
    { damper: _pn_vav4Damper, mode: _pn_vav4Mode, num: 4 },
    { damper: _pn_vav5Damper, mode: _pn_vav5Mode, num: 5 },
    { damper: _pn_vav6Damper, mode: _pn_vav6Mode, num: 6 }
  ];

  vavs.forEach(function(vav) {
    const modeText = ['Off', 'Heating', 'Cooling'][vav.mode] || 'Unknown';
    const statusText = modeText + ' - ' + Math.round(vav.damper) + '%';
    const statusElem = document.getElementById('vav' + vav.num + 'Status');
    const indicator = document.getElementById('vav' + vav.num + 'Indicator');

    if (statusElem) statusElem.textContent = statusText;
    if (indicator) {
      if (vav.mode === 0) {
        indicator.setAttribute('fill', '#718096');
      } else if (vav.mode === 1) {
        indicator.setAttribute('fill', '#f56565');
      } else if (vav.mode === 2) {
        indicator.setAttribute('fill', '#48bb78');
      }
    }
  });
}

function putValue(id, value) {
  if (id === '_ps_zoneName') {
    _ps_zoneName = String(value);
  } else if (id === '_pn_avgTemp') {
    _pn_avgTemp = Number(value) || 0;
  } else if (id === '_pn_totalOccupancy') {
    _pn_totalOccupancy = Number(value) || 0;
  } else if (id === '_pn_maxOccupancy') {
    _pn_maxOccupancy = Number(value) || 0;
  } else if (id === '_pn_vavActive') {
    _pn_vavActive = Number(value) || 0;
  } else if (id === '_pn_temp1') {
    _pn_temp1 = Number(value) || 0;
  } else if (id === '_pn_occ1') {
    _pn_occ1 = Number(value) || 0;
  } else if (id === '_pn_temp2') {
    _pn_temp2 = Number(value) || 0;
  } else if (id === '_pn_occ2') {
    _pn_occ2 = Number(value) || 0;
  } else if (id === '_pn_temp3') {
    _pn_temp3 = Number(value) || 0;
  } else if (id === '_pn_occ3') {
    _pn_occ3 = Number(value) || 0;
  } else if (id === '_pn_temp4') {
    _pn_temp4 = Number(value) || 0;
  } else if (id === '_pn_occ4') {
    _pn_occ4 = Number(value) || 0;
  } else if (id === '_pn_temp5') {
    _pn_temp5 = Number(value) || 0;
  } else if (id === '_pn_occ5') {
    _pn_occ5 = Number(value) || 0;
  } else if (id === '_pn_temp6') {
    _pn_temp6 = Number(value) || 0;
  } else if (id === '_pn_occ6') {
    _pn_occ6 = Number(value) || 0;
  } else if (id === '_pn_temp7') {
    _pn_temp7 = Number(value) || 0;
  } else if (id === '_pn_occ7') {
    _pn_occ7 = Number(value) || 0;
  } else if (id === '_pn_vav1Damper') {
    _pn_vav1Damper = Number(value) || 0;
  } else if (id === '_pn_vav1Mode') {
    _pn_vav1Mode = Number(value) || 0;
  } else if (id === '_pn_vav2Damper') {
    _pn_vav2Damper = Number(value) || 0;
  } else if (id === '_pn_vav2Mode') {
    _pn_vav2Mode = Number(value) || 0;
  } else if (id === '_pn_vav3Damper') {
    _pn_vav3Damper = Number(value) || 0;
  } else if (id === '_pn_vav3Mode') {
    _pn_vav3Mode = Number(value) || 0;
  } else if (id === '_pn_vav4Damper') {
    _pn_vav4Damper = Number(value) || 0;
  } else if (id === '_pn_vav4Mode') {
    _pn_vav4Mode = Number(value) || 0;
  } else if (id === '_pn_vav5Damper') {
    _pn_vav5Damper = Number(value) || 0;
  } else if (id === '_pn_vav5Mode') {
    _pn_vav5Mode = Number(value) || 0;
  } else if (id === '_pn_vav6Damper') {
    _pn_vav6Damper = Number(value) || 0;
  } else if (id === '_pn_vav6Mode') {
    _pn_vav6Mode = Number(value) || 0;
  }

  update();
}

init();
]]></script>
</svg>
