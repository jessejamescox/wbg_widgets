<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 350 400" width="350" height="400">
  <defs>
    <style>
      .damper-housing { fill: #bdbdbd; stroke: #333; stroke-width: 2; }
      .damper-blade { fill: #757575; stroke: #424242; stroke-width: 2; transition: all 0.5s; }
      .damper-frame { fill: none; stroke: #333; stroke-width: 3; }
      .fusible-link { fill: #FF9800; stroke: #E65100; stroke-width: 2; }
      .link-broken { fill: #f44336; }
      .airflow-arrow { fill: #2196F3; opacity: 0.6; }
      .status-open { fill: #4CAF50; }
      .status-closed { fill: #f44336; }
      .alarm-indicator { fill: #f44336; opacity: 0; }
      .alarm-active { animation: alarmBlink 1s infinite; }
      .label-text { fill: #333; font-family: Arial, sans-serif; font-size: 14px; text-anchor: middle; }
      .value-text { fill: #333; font-family: Arial, sans-serif; font-size: 13px; font-weight: bold; text-anchor: middle; }
      .title-text { fill: #333; font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; text-anchor: middle; }
      .small-text { fill: #666; font-family: Arial, sans-serif; font-size: 11px; text-anchor: middle; }

      @keyframes alarmBlink {
        0%, 49% { opacity: 1; }
        50%, 100% { opacity: 0; }
      }
    </style>

    <linearGradient id="metalGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#e0e0e0;stop-opacity:1" />
      <stop offset="50%" style="stop-color:#bdbdbd;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#9e9e9e;stop-opacity:1" />
    </linearGradient>
  </defs>

  <!-- Title -->
  <text x="175" y="25" class="title-text">FIRE/SMOKE DAMPER</text>

  <!-- Main Damper Assembly -->
  <g id="damper-assembly">
    <!-- Housing -->
    <rect x="75" y="60" width="200" height="180" rx="5" class="damper-housing" fill="url(#metalGradient)"/>

    <!-- Frame opening -->
    <rect x="95" y="80" width="160" height="140" class="damper-frame"/>

    <!-- Airflow arrows (visible when open) -->
    <g id="airflow-indicators">
      <polygon points="110,130 130,120 130,125 145,125 145,135 130,135 130,140" class="airflow-arrow"/>
      <polygon points="150,130 170,120 170,125 185,125 185,135 170,135 170,140" class="airflow-arrow"/>
      <polygon points="190,130 210,120 210,125 225,125 225,135 210,135 210,140" class="airflow-arrow"/>
      <polygon points="110,170 130,160 130,165 145,165 145,175 130,175 130,180" class="airflow-arrow"/>
      <polygon points="150,170 170,160 170,165 185,165 185,175 170,175 170,180" class="airflow-arrow"/>
      <polygon points="190,170 210,160 210,165 225,165 225,175 210,175 210,180" class="airflow-arrow"/>
    </g>

    <!-- Damper blade -->
    <g id="blade-group">
      <rect x="100" y="145" width="150" height="10" rx="2" class="damper-blade" id="damper-blade"/>
      <!-- Blade pivot -->
      <circle cx="175" cy="150" r="8" fill="#424242" stroke="#212121" stroke-width="2"/>
      <circle cx="175" cy="150" r="3" fill="#757575"/>
    </g>

    <!-- Fusible link -->
    <g id="fusible-link-group">
      <rect x="260" y="140" width="50" height="20" rx="3" id="fusible-link" class="fusible-link"/>
      <circle cx="270" cy="150" r="6" fill="#E65100"/>
      <circle cx="300" cy="150" r="6" fill="#E65100"/>
      <line x1="276" y1="150" x2="294" y2="150" stroke="#fff" stroke-width="2"/>
      <text x="285" y="177" class="small-text">FUSIBLE LINK</text>
    </g>
  </g>

  <!-- Status Indicators -->
  <g id="status-panel">
    <!-- Position Status -->
    <rect x="50" y="260" width="120" height="50" rx="5" fill="#ffffff" stroke="#666" stroke-width="2"/>
    <text x="110" y="278" class="label-text">Position:</text>
    <text x="110" y="298" id="position-text" class="value-text">OPEN</text>

    <!-- Link Status -->
    <rect x="180" y="260" width="120" height="50" rx="5" fill="#ffffff" stroke="#666" stroke-width="2"/>
    <text x="240" y="278" class="label-text">Fusible Link:</text>
    <text x="240" y="298" id="link-text" class="value-text">INTACT</text>

    <!-- Alarm Indicator -->
    <g id="alarm-display">
      <circle cx="175" cy="340" r="30" fill="#ffffff" stroke="#666" stroke-width="2"/>
      <circle cx="175" cy="340" r="20" id="alarm-light" class="alarm-indicator"/>
      <text x="175" y="380" class="label-text">ALARM</text>
    </g>
  </g>

  <script type="text/javascript"><![CDATA[
    (function() {
      var svg = document.currentScript.closest('svg');

      // State variables
  <script><![CDATA[
//!export-start
let _pn_position = 1;      // Position: 0=closed, 1=open
let _pn_fault = 0;         // Fault: 0=ok, 1=fault
let _ps_location = "Duct 12A"; // Location
//!export-end

function init() { update(); }

function update() {
  const positionText = document.getElementById('positionText');
  const damperBlade = document.getElementById('damperBlade');
  const faultIndicator = document.getElementById('faultIndicator');
  const locationText = document.getElementById('locationText');
  if (!positionText) return;
  positionText.textContent = _pn_position ? 'OPEN' : 'CLOSED';
  if (damperBlade) damperBlade.setAttribute('transform', _pn_position ? 'rotate(0)' : 'rotate(90)');
  if (faultIndicator) faultIndicator.style.opacity = _pn_fault ? '1' : '0';
  if (locationText) locationText.textContent = _ps_location;
}

function putValue(id, value) {
  if (id === '_pn_position') _pn_position = Number(value) || 0;
  else if (id === '_pn_fault') _pn_fault = Number(value) || 0;
  else if (id === '_ps_location') _ps_location = String(value);
  update();
}

init();
]]></script>
</svg>
